
# Project Data
PROJECT_NAME=ddlang

EXECUTABLE=${PROJECT_NAME}
ENGINE=dd_pixi_engine.js
ENGINE_PATH=engines/pixi
INSTALL_LOCATION=@INSTALL_LOCATION@

SRC=*.c
HEADERS=$(wildcard *.h)

# compile the compiler itself
${EXECUTABLE}: ${SRC} lex.l yacc.y
	flex lex.l
	bison -d yacc.y
	gcc -DINSTALL_LOCATION=${INSTALL_LOCATION} -DPROJECT_NAME=${PROJECT_NAME} ${SRC} -o ${EXECUTABLE}

# compile the pixi engine
${ENGINE_PATH}${ENGINE}: ${ENGINE_PATH}
	${MAKE} -C ${ENGINE_PATH}

# install the project in the system
install: ${EXECUTABLE} ${ENGINE_PATH}/${ENGINE}
	mkdir -p ${INSTALL_LOCATION}/bin
	install ${EXECUTABLE} ${INSTALL_LOCATION}/bin/
	mkdir -p ${INSTALL_LOCATION}/share/${PROJECT_NAME}
	install ${ENGINE_PATH}/${ENGINE} ${INSTALL_LOCATION}/share/${PROJECT_NAME}/${ENGINE}
	install ${ENGINE_PATH}/index.html ${INSTALL_LOCATION}/share/${PROJECT_NAME}/index.html

clean:
	rm -f ${EXECUTABLE} lex.yy.c yacc.tab.c yacc.tab.h makefile
